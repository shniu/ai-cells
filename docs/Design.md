# Flash Instant Message System Design

## System Design

### 需求分析

作为一个即时通信的基础服务，需要提供 IM 的很多能力：

- 一对一聊天功能，这是一个 IM 最基本的功能需求
- 登录 / 注册 功能，IM 的一个准入，我们需要知道聊天的对象是谁
- 支持多端登录，不同端登录实现互踢，PC 和 移动端可同时在线
- IM 是相互通信的工具，一般情况下我们和好友或熟人聊天，所以需要支持添加好友等来维护好友关系
- 群聊功能，有时候我们有在一个群里沟通的需要
- 聊天室功能，作为一个开放的房间存在，可以随意进出
- 聊天发送的信息可以支持：文本，表情，图片；文件、地理位置、语音、视频以后再说
- 我们的用户不可能 7 * 24 小时的持续在线，我们需要支持离线消息，待用户上线后再做推送
- 离线消息推送，是当用户不在线时，可以通过手机的通知功能，以通知的形式推送给用户，来提醒他有消息到达
- 有时候我们需要会看聊天记录，对聊天记录做搜索等
- 作为一个底层基础设施，实时音视频也是目前绝大部分 IM 的刚需

IM 是一个基础设施服务，同样需要一些非功能性需求：

- 低延迟，消息的延迟性是要考虑的
- 作为 IM 肯定需要支持多人在线，比如百万用户同时在线
- 扩展性，我们开发出来的 IM 包括客户端和服务端，客户端以 SDK 的形式存在，而服务端需要有灵活的水平扩展能力
- 安全性，聊天毕竟具备很高的隐私，在通信过程中，聊天记录不能被窃取

参考一些 IM 平台：

- [网易云信](https://dev.yunxin.163.com/docs/product/IM%E5%8D%B3%E6%97%B6%E9%80%9A%E8%AE%AF/%E4%BA%A7%E5%93%81%E4%BB%8B%E7%BB%8D/%E7%AE%80%E4%BB%8B)
- [腾讯云 IM](https://cloud.tencent.com/document/product/269/1498)

### 设计

Flash IM 的系统设计文档

TODO

### Develop Solution

开发实现方案 TODO

## Reference

- [cim](https://crossoverjie.top/JCSprout/#/netty/cim)
- [CrazyIM](https://www.cnblogs.com/crazymakercircle/p/11470287.html)
